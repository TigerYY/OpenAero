# 重构路由架构提案

## 变更概述

**变更ID**: `refactor-routing-architecture`  
**优先级**: 高  
**影响范围**: 全栈路由系统  
**预计工作量**: 中等 (需要系统性重构)

## 问题描述

当前项目存在严重的路由架构不一致问题：

1. **硬编码路由与国际化架构冲突** - 大量组件使用硬编码路由（如 `href="/auth/login"`），但项目使用 `[locale]` 目录结构进行国际化
2. **路由使用不一致** - 部分组件使用新的 `useRouting()` 工具，但大部分组件仍使用硬编码路由
3. **中间件路由匹配不完整** - 中间件已支持国际化路径，但组件层未统一

这导致用户注册时出现"离线状态"错误，因为路由不匹配。

## 解决方案

### 核心重构目标

1. **统一路由处理策略** - 所有路由基于locale动态生成
2. **中间件国际化** - 中间件支持国际化路由匹配
3. **组件路由抽象** - 创建统一的路由生成工具函数

### 技术方案

- **统一使用 `useRouting()` hook** - 替换所有硬编码路由
- **完善 `RoutingUtils` 工具类** - 增强路由验证和生成能力
- **更新中间件逻辑** - 确保路由匹配一致性
- **添加路由检查工具** - 自动化检测硬编码路由

## 影响分析

### 受影响组件
- 所有导航组件 (`RoleBasedNavigation.tsx`, `EnhancedMobileNavigation.tsx`)
- 所有页面组件中的链接和重定向
- 所有API路由调用
- 中间件路由匹配逻辑

### 风险评估
- **高**: 需要系统性重构，可能影响现有功能
- **缓解措施**: 分阶段实施，充分测试

## 验收标准

- [ ] 所有硬编码路由替换为 `useRouting()`
- [ ] 中间件路由匹配正确
- [ ] 用户注册流程正常工作
- [ ] 国际化路由支持完整
- [ ] 自动化路由检查工具可用