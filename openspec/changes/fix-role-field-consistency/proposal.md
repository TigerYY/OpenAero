# 角色字段一致性修复提案

## 问题描述

当前用户管理系统存在角色字段不一致的问题：

1. **数据库层面**: `user_profiles` 表使用 `roles` 数组字段存储用户角色
2. **API层面**: 部分代码仍使用 `profile.role` 单个字段
3. **前端层面**: 混合使用 `roles` 数组和 `role` 字段进行权限检查

## 问题影响

- 权限验证不可靠
- 代码维护困难
- 潜在的安全风险
- 数据一致性问题

## 修复目标

1. 统一所有代码使用 `roles` 数组作为角色数据的唯一来源
2. 彻底移除对 `profile.role` 的依赖
3. 确保权限检查的一致性和可靠性
4. 保持向后兼容性

## 修复范围

- 后端API路由权限检查
- 前端组件权限验证
- 认证和授权相关工具函数
- 数据库查询和更新操作