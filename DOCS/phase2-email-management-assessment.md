# 阶段2：邮箱管理评估报告

## 1.5.1 邮箱修改功能

### 当前实现状态

#### ✅ 已实现
1. **重新发送验证邮件** (`/api/auth/resend-verification`)
   - 已实现重新发送验证邮件功能
   - 使用统一的API响应格式
   - 包含审计日志

#### ❌ 未实现
1. **邮箱修改功能**
   - 需要创建邮箱修改API端点
   - 需要密码验证
   - 需要发送验证邮件到新邮箱
   - 需要邮箱修改确认功能

## 1.5.2 邮箱验证完善

### 当前实现状态

#### ✅ 已实现
1. **重新发送验证邮件**
   - API端点已存在
   - 登录页面已集成

#### ⚠️ 部分实现
1. **邮箱验证状态检查**
   - 通过 `user.email_confirmed_at` 检查
   - 但缺少专门的API端点

#### ❌ 未实现
1. **邮箱验证过期处理**
   - 未实现验证链接过期检查
   - 未实现过期后重新发送

2. **未验证邮箱的功能限制**
   - 未实现功能限制逻辑
   - 未实现限制提示

## 实施计划

### 优先级 1：邮箱修改功能
1. 创建邮箱修改API (`/api/users/email/change`)
   - 需要密码验证
   - 发送验证邮件到新邮箱
   - 记录审计日志

2. 创建邮箱修改确认API (`/api/users/email/confirm`)
   - 验证token
   - 更新邮箱
   - 发送通知邮件

3. 创建邮箱修改页面
   - 输入新邮箱和密码
   - 显示验证状态

### 优先级 2：邮箱验证完善
1. 创建邮箱验证状态检查API (`/api/users/email/verification-status`)
2. 实现邮箱验证过期处理
3. 添加未验证邮箱的功能限制提示

