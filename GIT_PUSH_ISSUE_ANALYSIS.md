# Git æ¨é€å¤±è´¥é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ

**æ—¥æœŸ**: 2025-10-30  
**é”™è¯¯**: `GH001: Large files detected` - `openaero-web.tar.gz is 153.02 MB`

---

## ğŸ” é—®é¢˜æ ¹æœ¬åŸå› 

### é—®é¢˜ 1: Pre-commit Hook å¤±è´¥
- **é”™è¯¯**: Prettier æœªå®‰è£… (`spawn prettier ENOENT`)
- **å½±å“**: é˜»æ­¢æœ¬åœ°æäº¤ï¼ˆä½†å¯ä»¥ç”¨ `--no-verify` è·³è¿‡ï¼‰
- **ä¸¥é‡æ€§**: âš ï¸ ä¸­ç­‰ï¼ˆå¯ä»¥è·³è¿‡ï¼‰

### é—®é¢˜ 2: Git å†å²ä¸­çš„å¤§æ–‡ä»¶ï¼ˆä¸»è¦é—®é¢˜ï¼‰
- **é”™è¯¯**: `File openaero-web.tar.gz is 153.02 MB; this exceeds GitHub's file size limit of 100.00 MB`
- **æ ¹æœ¬åŸå› **: 
  - âœ… å·¥ä½œåŒºçš„ tar.gz æ–‡ä»¶å·²åˆ é™¤
  - âŒ ä½†è¿™äº›æ–‡ä»¶ä»ç„¶å­˜åœ¨äº **Git å†å²è®°å½•**ä¸­
  - GitHub æ£€æŸ¥æ•´ä¸ªæäº¤å†å²ï¼Œä¸åªæ˜¯å½“å‰å·¥ä½œåŒº
  
- **ä¸¥é‡æ€§**: ğŸ”´ **é«˜**ï¼ˆå¿…é¡»è§£å†³æ‰èƒ½æ¨é€ï¼‰

---

## ğŸ“Š å½“å‰çŠ¶æ€åˆ†æ

```
å·¥ä½œåŒºçŠ¶æ€: âœ… tar.gz æ–‡ä»¶å·²åˆ é™¤
Git å†å²:   âŒ tar.gz æ–‡ä»¶ä»ç„¶å­˜åœ¨
æ¨é€çŠ¶æ€:   âŒ è¢« GitHub æ‹’ç»
```

å³ä½¿å·¥ä½œåŒºæ²¡æœ‰å¤§æ–‡ä»¶ï¼Œåªè¦ Git å†å²ä¸­åŒ…å«å¤§æ–‡ä»¶ï¼ŒGitHub å°±ä¼šæ‹’ç»æ¨é€æ•´ä¸ªåˆ†æ”¯ã€‚

---

## ğŸ› ï¸ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ A: ä½¿ç”¨ git filter-repo ä»å†å²ä¸­ç§»é™¤ï¼ˆæ¨èï¼‰

è¿™æ˜¯æœ€å¹²å‡€çš„æ–¹æ³•ï¼Œä»æ‰€æœ‰å†å²æäº¤ä¸­ç§»é™¤å¤§æ–‡ä»¶ã€‚

#### æ­¥éª¤ 1: å®‰è£… git-filter-repo
```bash
# macOS
brew install git-filter-repo

# æˆ–ä½¿ç”¨ pip
pip3 install git-filter-repo
```

#### æ­¥éª¤ 2: å¤‡ä»½å½“å‰åˆ†æ”¯
```bash
# åˆ›å»ºå®Œæ•´å¤‡ä»½
git bundle create backup-$(date +%Y%m%d_%H%M%S).bundle --all
```

#### æ­¥éª¤ 3: ä»å†å²ä¸­ç§»é™¤æ‰€æœ‰ tar.gz æ–‡ä»¶
```bash
# ç§»é™¤æ‰€æœ‰ tar.gz æ–‡ä»¶çš„å†å²è®°å½•
git filter-repo --path-glob '*.tar.gz' --invert-paths

# å¦‚æœè¿˜æœ‰ tar æ–‡ä»¶
git filter-repo --path-glob '*.tar' --invert-paths
```

#### æ­¥éª¤ 4: å¼ºåˆ¶æ¨é€
```bash
# âš ï¸ æ³¨æ„ï¼šè¿™ä¼šé‡å†™å†å²ï¼Œéœ€è¦ä½¿ç”¨ --force
git push origin backup-before-tailwind-fix --force
```

---

### æ–¹æ¡ˆ B: ä½¿ç”¨ BFG Repo-Cleanerï¼ˆæ›´ç®€å•ï¼‰

BFG æ˜¯ä¸“é—¨ç”¨äºæ¸…ç† Git å†å²çš„å·¥å…·ï¼Œæ¯” filter-repo æ›´ç®€å•ã€‚

#### æ­¥éª¤ 1: ä¸‹è½½ BFG
```bash
# macOS
brew install bfg

# æˆ–ä¸‹è½½ JAR æ–‡ä»¶
# https://rtyley.github.io/bfg-repo-cleaner/
```

#### æ­¥éª¤ 2: åˆ›å»ºå¤‡ä»½
```bash
git clone --mirror https://github.com/TigerYY/OpenAero.git repo-backup.git
```

#### æ­¥éª¤ 3: æ¸…ç†å¤§æ–‡ä»¶
```bash
# ç§»é™¤æ‰€æœ‰å¤§äº 100MB çš„æ–‡ä»¶
bfg --strip-blobs-bigger-than 100M repo-backup.git

# æˆ–ç§»é™¤ç‰¹å®šæ–‡ä»¶
bfg --delete-files '*.tar.gz' repo-backup.git
```

#### æ­¥éª¤ 4: æ¸…ç†å¹¶æ¨é€
```bash
cd repo-backup.git
git reflog expire --expire=now --all
git gc --prune=now --aggressive

# ç„¶åæ¨é€åˆ°è¿œç¨‹
git push --force
```

---

### æ–¹æ¡ˆ C: åˆ›å»ºæ–°çš„å¹²å‡€åˆ†æ”¯ï¼ˆæœ€ç®€å•ï¼Œä½†ä¼šä¸¢å¤±å†å²ï¼‰

å¦‚æœå†å²è®°å½•ä¸é‡è¦ï¼Œå¯ä»¥åˆ›å»ºæ–°åˆ†æ”¯ã€‚

#### æ­¥éª¤ 1: åˆ›å»ºæ–°çš„å¹²å‡€åˆ†æ”¯
```bash
# åˆ›å»ºæ–°çš„å­¤å„¿åˆ†æ”¯ï¼ˆæ— å†å²ï¼‰
git checkout --orphan clean-branch

# æ·»åŠ å½“å‰æ‰€æœ‰æ–‡ä»¶
git add -A

# æäº¤
git commit -m "é¡¹ç›®æ–‡ä»¶æ¸…ç† - å¹²å‡€ç‰ˆæœ¬ï¼ˆæ— å†å²å¤§æ–‡ä»¶ï¼‰"
```

#### æ­¥éª¤ 2: æ¨é€åˆ°æ–°åˆ†æ”¯
```bash
git push origin clean-branch
```

---

### æ–¹æ¡ˆ D: è·³è¿‡ Pre-commit Hookï¼ˆä¸´æ—¶è§£å†³ï¼‰

å¦‚æœåªæƒ³è·³è¿‡æ ¼å¼æ£€æŸ¥ï¼Œå¯ä»¥ä½¿ç”¨ï¼š

```bash
git commit --no-verify -m "é¡¹ç›®æ–‡ä»¶æ¸…ç†"

# ä½†ä»éœ€è§£å†³å†å²å¤§æ–‡ä»¶é—®é¢˜æ‰èƒ½æ¨é€
```

---

## âš ï¸ é‡è¦è­¦å‘Š

### å…³äºå†å²é‡å†™

å¦‚æœä½¿ç”¨æ–¹æ¡ˆ A æˆ– Bï¼š
1. **ä¼šé‡å†™ Git å†å²** - æ‰€æœ‰æäº¤çš„ SHA éƒ½ä¼šæ”¹å˜
2. **å½±å“å…¶ä»–å¼€å‘è€…** - å¦‚æœå…¶ä»–äººä¹Ÿåœ¨ä½¿ç”¨è¿™ä¸ªåˆ†æ”¯ï¼Œéœ€è¦é‡æ–°å…‹éš†
3. **åˆ›å»ºå¤‡ä»½** - åœ¨æ‰§è¡Œå‰åŠ¡å¿…åˆ›å»ºå®Œæ•´å¤‡ä»½

### æ“ä½œå»ºè®®

1. âœ… **å…ˆå¤‡ä»½**: `git bundle create backup.bundle --all`
2. âœ… **ç¡®è®¤åˆ†æ”¯**: ç¡®ä¿åœ¨æ­£ç¡®çš„åˆ†æ”¯ä¸Šæ“ä½œ
3. âœ… **æµ‹è¯•æœ¬åœ°**: å†å²é‡å†™åï¼Œå…ˆæµ‹è¯•æœ¬åœ°ä»“åº“
4. âœ… **é€šçŸ¥å›¢é˜Ÿ**: å¦‚æœè¿™æ˜¯å…±äº«åˆ†æ”¯ï¼Œé€šçŸ¥å…¶ä»–æˆå‘˜

---

## ğŸ¯ æ¨èæ‰§è¡Œæ­¥éª¤

### å¿«é€Ÿæ–¹æ¡ˆï¼ˆé€‚åˆä¸ªäººé¡¹ç›®ï¼‰

```bash
# 1. åˆ›å»ºå¤‡ä»½
git bundle create backup-$(date +%Y%m%d).bundle --all

# 2. å®‰è£… git-filter-repoï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
brew install git-filter-repo || pip3 install git-filter-repo

# 3. ç§»é™¤å¤§æ–‡ä»¶å†å²
git filter-repo --path-glob '*.tar.gz' --invert-paths
git filter-repo --path-glob '*.tar' --invert-paths

# 4. å¼ºåˆ¶æ¨é€
git push origin backup-before-tailwind-fix --force
```

### å®‰å…¨æ–¹æ¡ˆï¼ˆé€‚åˆå›¢é˜Ÿé¡¹ç›®ï¼‰

```bash
# 1. åˆ›å»ºæ–°åˆ†æ”¯ï¼ˆä¿ç•™åŸåˆ†æ”¯ä½œä¸ºå¤‡ä»½ï¼‰
git checkout -b project-cleanup-20251030

# 2. åˆ›å»ºå¹²å‡€çš„æäº¤
git add -A
git commit --no-verify -m "é¡¹ç›®æ–‡ä»¶æ¸…ç† - å¹²å‡€ç‰ˆæœ¬"

# 3. æ¨é€åˆ°æ–°åˆ†æ”¯
git push origin project-cleanup-20251030
```

---

## ğŸ“ æ‰§è¡Œæ£€æŸ¥æ¸…å•

åœ¨æ“ä½œå‰ç¡®è®¤ï¼š

- [ ] å·²åˆ›å»º Git å¤‡ä»½åŒ…ï¼ˆ`.bundle` æ–‡ä»¶ï¼‰
- [ ] ç¡®è®¤å½“å‰åˆ†æ”¯åç§°
- [ ] ç¡®è®¤è¿œç¨‹ä»“åº“åœ°å€
- [ ] å·²é€šçŸ¥å›¢é˜Ÿæˆå‘˜ï¼ˆå¦‚æœæ˜¯å…±äº«åˆ†æ”¯ï¼‰
- [ ] å·²å¤‡ä»½é‡è¦å·¥ä½œï¼ˆå¦‚æœ‰æœªæäº¤æ›´æ”¹ï¼‰

---

## ğŸ”„ éªŒè¯æ­¥éª¤

æ“ä½œåéªŒè¯ï¼š

```bash
# 1. ç¡®è®¤å¤§æ–‡ä»¶å·²ä»å†å²ä¸­ç§»é™¤
git rev-list --objects --all | grep -E "\.tar\.gz$"

# åº”è¯¥è¿”å›ç©ºç»“æœ

# 2. æ£€æŸ¥ä»“åº“å¤§å°
du -sh .git

# 3. å°è¯•æ¨é€åˆ°æµ‹è¯•åˆ†æ”¯
git push origin backup-before-tailwind-fix --dry-run
```

---

**éœ€è¦å¸®åŠ©ï¼Ÿ** æˆ‘å¯ä»¥ååŠ©æ‰§è¡Œä¸Šè¿°ä»»ä½•ä¸€ä¸ªæ–¹æ¡ˆã€‚

